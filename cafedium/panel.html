<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cofedium Διαχειριστής</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="coffeetime.png">
    <link rel="apple-touch-icon" href="coffeetime.png">
    <link rel="shortcut icon" href="coffeetime.png" type="image/x-icon">
    <meta name="msapplication-TileImage" content="coffeetime.png">
    <meta name="msapplication-TileColor" content="#8B4513">
    <meta name="theme-color" content="#8B4513">
    
    <style>
        :root {
            --primary: #8B4513;
            --primary-light: #A0522D;
            --secondary: #D2691E;
            --accent: #F4A460;
            --light: #F5F5DC;
            --dark: #3E2723;
            --text: #5D4037;
            --success: #4CAF50;
            --error: #f44336;
            --info: #2196F3;
            --warning: #FF9800;
            --card-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            --hover-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--light) 0%, #f8f4e9 100%);
            color: var(--text);
            line-height: 1.5;
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Login Modal Styles */
        #login-modal {
            display: flex;
            background: rgba(0, 0, 0, 0.8);
        }
        
        .login-modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 450px;
            margin: auto;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        .login-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        .login-logo {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .login-title {
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .login-body {
            padding: 25px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            font-size: 0.95rem;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0d6c9;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
            background: #fcfaf7;
        }
        
        .form-control:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1);
            background: white;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }
        
        .login-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 69, 19, 0.3);
        }
        
        .login-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }
        
        .setup-info {
            margin-top: 20px;
            padding: 15px;
            background: #f8f4e9;
            border-radius: 8px;
            border-left: 4px solid var(--info);
        }
        
        .setup-info h4 {
            color: var(--dark);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .setup-info p {
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        /* Main App Styles */
        .main-content {
            display: none;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            transform: rotate(30deg);
        }
        
        .logo {
            font-size: 2.2rem;
            margin-bottom: 8px;
            display: block;
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 0.95rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .admin-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            background: white;
            padding: 12px 16px;
            border-radius: 8px;
            box-shadow: var(--card-shadow);
        }
        
        .admin-welcome {
            font-weight: 600;
            color: var(--primary);
            font-size: 0.95rem;
        }
        
        .logout-btn {
            background: var(--error);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
            font-size: 0.9rem;
        }
        
        .logout-btn:hover {
            background: #c62828;
        }

        .main-app-btn {
            background: var(--success);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
            font-size: 0.9rem;
            margin-right: 8px;
        }
        
        .main-app-btn:hover {
            background: #388e3c;
        }

        .sync-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
            font-size: 0.9rem;
            margin-right: 8px;
        }
        
        .sync-btn:hover {
            background: var(--primary-light);
        }
        
        .admin-actions {
            display: flex;
            gap: 8px;
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 16px;
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--hover-shadow);
        }
        
        .stat-icon {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 4px;
            color: var(--dark);
        }
        
        .stat-label {
            color: var(--text);
            font-weight: 500;
            font-size: 0.85rem;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 16px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            flex-wrap: wrap;
        }
        
        .tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: #f8f4e9;
            border: none;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            min-width: 120px;
        }
        
        .tab.active {
            background: white;
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }
        
        .tab:hover:not(.active) {
            background: #f0e6d3;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .content-section {
            background-color: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            margin-bottom: 20px;
            border: 1px solid rgba(210, 105, 30, 0.1);
        }
        
        h2 {
            color: var(--primary);
            margin-bottom: 16px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.3rem;
        }
        
        h2 i {
            color: var(--secondary);
        }
        
        .filters {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }
        
        .filter-select, .search-input {
            padding: 8px 12px;
            border: 1px solid #e0d6c9;
            border-radius: 6px;
            background: #fcfaf7;
            font-size: 0.9rem;
            color: var(--text);
            flex: 1;
            min-width: 140px;
        }
        
        .search-input {
            flex: 2;
            min-width: 180px;
        }
        
        .submissions-list {
            display: grid;
            gap: 16px;
        }
        
        .submission-card {
            background: #fcfaf7;
            border-radius: 8px;
            padding: 16px;
            box-shadow: var(--card-shadow);
            border-left: 3px solid var(--accent);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .submission-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--hover-shadow);
        }
        
        .submission-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .submission-user {
            font-weight: 600;
            color: var(--dark);
            font-size: 1rem;
        }
        
        .submission-date {
            color: var(--text);
            font-size: 0.8rem;
        }
        
        .submission-status {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-reviewed {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .status-answered {
            background: #d4edda;
            color: #155724;
        }
        
        .submission-content {
            margin-bottom: 12px;
        }
        
        .submission-message {
            margin-bottom: 12px;
            line-height: 1.4;
            font-size: 0.9rem;
        }
        
        .photos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 8px;
            margin-top: 8px;
        }
        
        .photo-item {
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }
        
        .photo-image {
            width: 100%;
            height: 100px;
            object-fit: cover;
            display: block;
        }
        
        .submission-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 6px 10px;
            border: none;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.8rem;
        }
        
        .btn-view {
            background: var(--info);
            color: white;
        }
        
        .btn-view:hover {
            background: #0b7dda;
        }
        
        .btn-reply {
            background: var(--success);
            color: white;
        }
        
        .btn-reply:hover {
            background: #388e3c;
        }
        
        .btn-delete {
            background: var(--error);
            color: white;
        }
        
        .btn-delete:hover {
            background: #d32f2f;
        }
        
        .btn-download {
            background: var(--primary);
            color: white;
        }
        
        .btn-download:hover {
            background: var(--primary-light);
        }
        
        .empty-state {
            text-align: center;
            padding: 30px 16px;
            color: var(--text);
        }
        
        .empty-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
            color: #e0d6c9;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 16px;
            gap: 4px;
        }
        
        .page-btn {
            padding: 6px 10px;
            border: 1px solid #e0d6c9;
            background: white;
            color: var(--text);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85rem;
        }
        
        .page-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .page-btn:hover:not(.active) {
            background: #f0e6d3;
        }
        
        footer {
            text-align: center;
            margin-top: 25px;
            padding: 16px;
            color: var(--primary-light);
            font-size: 0.85rem;
        }
        
        .coffee-icon {
            display: inline-block;
            margin: 0 4px;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-3px); }
            100% { transform: translateY(0px); }
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 10px;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        .modal-header {
            padding: 16px;
            border-bottom: 1px solid #e0d6c9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.3rem;
            cursor: pointer;
            color: var(--text);
        }
        
        .modal-body {
            padding: 16px;
        }
        
        .reply-form {
            margin-top: 16px;
        }
        
        .form-group {
            margin-bottom: 12px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 4px;
            font-weight: 600;
            color: var(--dark);
            font-size: 0.9rem;
        }
        
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #e0d6c9;
            border-radius: 6px;
            font-size: 0.9rem;
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }
        
        textarea:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 2px rgba(210, 105, 30, 0.2);
        }
        
        .modal-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-top: 16px;
        }

        /* URL preview και links */
        .url-preview {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 12px;
            margin: 12px 0;
        }

        .url-preview h4 {
            margin-bottom: 8px;
            color: var(--dark);
            font-size: 0.85rem;
        }

        .url-item {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 6px;
            padding: 6px;
            background: white;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .url-item:last-child {
            margin-bottom: 0;
        }

        .url-item i {
            color: var(--primary);
        }

        .preview-link {
            color: var(--primary);
            text-decoration: none;
            flex: 1;
            word-break: break-all;
        }

        .preview-link:hover {
            text-decoration: underline;
        }

        .url-note {
            font-size: 0.7rem;
            color: #6c757d;
            white-space: nowrap;
        }

        /* Προβολή μηνυμάτων με links */
        .message-link {
            color: var(--primary);
            text-decoration: underline;
            word-break: break-all;
        }

        .message-link:hover {
            color: var(--primary-light);
            text-decoration: none;
        }

        .submission-message a {
            color: var(--primary);
            text-decoration: underline;
            word-break: break-all;
        }

        .submission-message a:hover {
            color: var(--primary-light);
            text-decoration: none;
        }
        
        /* Πίνακας χρηστών */
        .users-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
            font-size: 0.85rem;
        }
        
        .users-table th, .users-table td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid #e0d6c9;
        }
        
        .users-table th {
            background-color: #f8f4e9;
            color: var(--primary);
            font-weight: 600;
        }
        
        .users-table tr:hover {
            background-color: #fcfaf7;
        }
        
        .user-actions {
            display: flex;
            gap: 6px;
        }
        
        .user-actions .action-btn {
            padding: 4px 8px;
            font-size: 0.75rem;
        }

        /* Ειδοποιήσεις */
        .notifications-badge {
            background: var(--error);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.65rem;
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: -4px;
            right: -4px;
        }
        
        /* Διαχείριση προσφορών */
        .offer-management {
            display: grid;
            gap: 16px;
        }
        
        .offer-item {
            background: #fcfaf7;
            border-radius: 8px;
            padding: 16px;
            border: 1px solid #e0d6c9;
        }
        
        .offer-item h3 {
            color: var(--primary);
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .offer-controls {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #e0d6c9;
        }
        
        .offer-status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 8px;
        }
        
        .status-active {
            background: #d4edda;
            color: #155724;
        }
        
        .status-inactive {
            background: #f8d7da;
            color: #721c24;
        }
        
        .offer-expiry {
            font-size: 0.85rem;
            color: var(--text);
            margin-top: 4px;
        }
        
        /* Κατηγορίες χρηστών */
        .user-category {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 6px;
        }
        
        .category-beginner {
            background: #e3f2fd;
            color: #1565c0;
        }
        
        .category-regular {
            background: #e8f5e9;
            color: #2e7d32;
        }
        
        .category-vip {
            background: #fff3e0;
            color: #ef6c00;
        }
        
        .category-master {
            background: #fce4ec;
            color: #c2185b;
        }
        
        /* Βελτιωμένες ειδοποιήσεις */
        .notification-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            padding: 16px;
            max-width: 320px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            border-left: 4px solid var(--info);
        }
        
        .notification-toast.show {
            transform: translateX(0);
        }
        
        .notification-icon {
            font-size: 1.2rem;
            color: var(--info);
            margin-top: 2px;
        }
        
        .notification-content {
            flex: 1;
        }
        
        .notification-title {
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--dark);
        }
        
        .notification-message {
            font-size: 0.85rem;
            color: var(--text);
            line-height: 1.4;
        }
        
        .notification-close {
            background: none;
            border: none;
            font-size: 1rem;
            cursor: pointer;
            color: var(--text);
            opacity: 0.7;
        }
        
        .notification-close:hover {
            opacity: 1;
        }

        /* Επιπλέον στυλ για καφεμαντεία */
        .coffee-reading-info {
            background: #f8f4e9;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 10px;
            border-left: 3px solid var(--primary);
        }

        .coffee-reading-info p {
            margin: 4px 0;
            font-size: 0.85rem;
        }

        /* Επιπλέον στυλ για καφεμάντη */
        .fortune-teller-info {
            background: linear-gradient(135deg, #f3e5f5, #e1bee7);
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 10px;
            border-left: 3px solid #9C27B0;
        }

        .fortune-teller-info p {
            margin: 4px 0;
            font-size: 0.85rem;
            font-weight: 500;
        }

        /* Sound notification */
        .sound-notification {
            display: none;
        }

        /* Success animation */
        .success-animation {
            text-align: center;
            padding: 20px;
        }

        .success-animation i {
            font-size: 3rem;
            color: var(--success);
            margin-bottom: 15px;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 5px;
            }
            
            header {
                padding: 16px 12px;
                margin-bottom: 16px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .logo {
                font-size: 1.8rem;
            }
            
            .admin-info {
                flex-direction: column;
                gap: 12px;
                text-align: center;
            }

            .admin-actions {
                justify-content: center;
                width: 100%;
            }
            
            .stats-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                min-width: 100%;
            }
            
            .content-section {
                padding: 16px 12px;
            }
            
            .filters {
                flex-direction: column;
            }
            
            .submission-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .submission-actions {
                width: 100%;
                justify-content: center;
            }
            
            .photos-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
            
            .photo-image {
                height: 80px;
            }

            .url-preview {
                padding: 8px;
            }

            .url-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 4px;
            }

            .url-note {
                white-space: normal;
            }
            
            .users-table {
                display: block;
                overflow-x: auto;
            }
            
            .user-actions {
                flex-direction: column;
            }
            
            .notification-toast {
                right: 10px;
                left: 10px;
                max-width: none;
            }
        }
        
        @media (max-width: 480px) {
            .stats-cards {
                grid-template-columns: 1fr;
            }
            
            .photos-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .submission-actions {
                flex-direction: column;
            }
            
            .action-btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="modal" id="login-modal">
        <div class="login-modal-content">
            <div class="login-header">
                <i class="fas fa-mug-hot login-logo"></i>
                <h2 class="login-title">Σύνδεση Διαχειριστή</h2>
            </div>
            <div class="login-body">
                <div class="form-group">
                    <label for="admin-email"><i class="fas fa-envelope"></i> Email Διαχειριστή:</label>
                    <input type="email" id="admin-email" class="form-control" placeholder="admin@cofedium.gr" required>
                </div>
                
                <div class="form-group">
                    <label for="admin-password"><i class="fas fa-lock"></i> Κωδικός Πρόσβασης:</label>
                    <input type="password" id="admin-password" class="form-control" placeholder="Εισάγετε τον κωδικό σας" required>
                </div>
                
                <div class="form-group checkbox-group">
                    <input type="checkbox" id="remember-me">
                    <label for="remember-me">Να με θυμάσαι</label>
                </div>
                
                <button class="login-btn" id="admin-login-btn">
                    <i class="fas fa-sign-in-alt"></i> Σύνδεση
                </button>
                
                <div class="setup-info" id="first-time-setup" style="display: none;">
                    <h4><i class="fas fa-info-circle"></i> Πρώτη Σύνδεση</h4>
                    <p>Εφόσον είναι η πρώτη σας σύνδεση, θα δημιουργηθεί νέος λογαριασμός διαχειριστή με τα διαπιστευτήρια που εισάγατε. Αυτά τα διαπιστευτήρια θα είναι διαθέσιμα από οποιοδήποτε browser.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application Content -->
    <div class="main-content" id="main-content">
        <div class="container">
            <header>
                <i class="fas fa-mug-hot logo"></i>
                <h1>Πίνακας Διαχειριστή</h1>
                <p class="subtitle">Διαχείριση υποβολών και μηνυμάτων από επισκέπτες</p>
            </header>
            
            <div class="admin-info">
                <div class="admin-welcome">
                    <i class="fas fa-user-shield"></i> Καλώς ήρθες, <span id="admin-name">Διαχειριστή</span>!
                </div>
                <div class="admin-actions">
                    <button class="main-app-btn" id="mainAppBtn">
                        <i class="fas fa-home"></i> Κύρια Εφαρμογή
                    </button>
                    <button class="sync-btn" id="syncUsersBtn">
                        <i class="fas fa-sync"></i> Συγχρονισμός
                    </button>
                    <button class="logout-btn" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i> Αποσύνδεση
                    </button>
                </div>
            </div>
            
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-images"></i>
                    </div>
                    <div class="stat-number" id="total-submissions">0</div>
                    <div class="stat-label">Συνολικές Υποβολές</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-number" id="pending-submissions">0</div>
                    <div class="stat-label">Υποβολές σε Εκκρεμότητα</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-number" id="answered-submissions">0</div>
                    <div class="stat-label">Απαντημένες Υποβολές</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-number" id="registered-users">0</div>
                    <div class="stat-label">Εγγεγραμμένοι Χρήστες</div>
                </div>
            </div>
            
            <div class="tabs">
                <button class="tab active" data-tab="photos-tab">
                    <i class="fas fa-camera"></i> Υποβολές
                </button>
                <button class="tab" data-tab="messages-tab">
                    <i class="fas fa-envelope"></i> Μηνύματα
                </button>
                <button class="tab" data-tab="users-tab">
                    <i class="fas fa-users"></i> Χρήστες
                </button>
                <button class="tab" data-tab="offers-tab">
                    <i class="fas fa-gift"></i> Προσφορές
                </button>
                <button class="tab" data-tab="notifications-tab" id="notificationsTab">
                    <i class="fas fa-bell"></i> Ειδοποιήσεις
                    <span class="notifications-badge" id="notificationsBadge" style="display: none;">0</span>
                </button>
            </div>
            
            <main>
                <!-- Καρτέλα Υποβολών Φωτογραφιών -->
                <section id="photos-tab" class="tab-content active">
                    <div class="content-section">
                        <h2><i class="fas fa-images"></i> Υποβολές Φωτογραφιών Καφέ</h2>
                        
                        <div class="filters">
                            <select class="filter-select" id="status-filter">
                                <option value="all">Όλες οι Καταστάσεις</option>
                                <option value="pending">Σε Εκκρεμότητα</option>
                                <option value="reviewed">Εξετασμένες</option>
                                <option value="answered">Απαντημένες</option>
                            </select>
                            
                            <select class="filter-select" id="date-filter">
                                <option value="all">Όλες οι Ημερομηνίες</option>
                                <option value="today">Σήμερα</option>
                                <option value="week">Τελευταία 7 Ημέρες</option>
                                <option value="month">Τελευταίος Μήνας</option>
                            </select>
                            
                            <input type="text" class="search-input" id="search-input" placeholder="Αναζήτηση με email...">
                        </div>
                        
                        <div class="submissions-list" id="photo-submissions-list">
                            <!-- Θα προστεθούν δυναμικά οι υποβολές -->
                        </div>
                    </div>
                </section>
                
                <!-- Καρτέλα Μηνυμάτων Επικοινωνίας -->
                <section id="messages-tab" class="tab-content">
                    <div class="content-section">
                        <h2><i class="fas fa-comments"></i> Μηνύματα Επικοινωνίας</h2>
                        
                        <div class="filters">
                            <select class="filter-select" id="message-status-filter">
                                <option value="all">Όλα τα Μηνύματα</option>
                                <option value="pending">Σε Εκκρεμότητα</option>
                                <option value="answered">Απαντημένα</option>
                            </select>
                            
                            <input type="text" class="search-input" id="message-search-input" placeholder="Αναζήτηση με όνομα ή email...">
                        </div>
                        
                        <div class="submissions-list" id="message-submissions-list">
                            <!-- Θα προστεθούν δυναμικά τα μηνύματα -->
                        </div>
                    </div>
                </section>
                
                <!-- Καρτέλα Διαχείρισης Χρηστών -->
                <section id="users-tab" class="tab-content">
                    <div class="content-section">
                        <h2><i class="fas fa-users"></i> Διαχείριση Εγγεγραμμένων Χρηστών</h2>
                        
                        <div class="filters">
                            <input type="text" class="search-input" id="user-search-input" placeholder="Αναζήτηση με όνομα ή email...">
                        </div>
                        
                        <div class="users-list" id="users-list">
                            <!-- Θα προστεθεί δυναμικά ο πίνακας χρηστών -->
                        </div>
                    </div>
                </section>

                <!-- Καρτέλα Διαχείρισης Προσφορών -->
                <section id="offers-tab" class="tab-content">
                    <div class="content-section">
                        <h2><i class="fas fa-gift"></i> Διαχείριση Προσφορών</h2>
                        
                        <div class="offer-management">
                            <div class="offer-item">
                                <h3>Προσφορά 1+1 Δώρο</h3>
                                <p>Ενεργοποίηση της προσφοράς 1+1 δώρο για όλους τους χρήστες.</p>
                                
                                <div class="offer-controls">
                                    <div class="form-group">
                                        <label for="offer-1plus1-status">Κατάσταση:</label>
                                        <select class="filter-select" id="offer-1plus1-status">
                                            <option value="active">Ενεργή</option>
                                            <option value="inactive">Ανενεργή</option>
                                        </select>
                                    </div>
                                        
                                    <div class="form-group">
                                        <label for="offer-1plus1-duration">Διάρκεια (ώρες):</label>
                                        <input type="number" id="offer-1plus1-duration" class="filter-select" min="1" max="168" value="24">
                                    </div>
                                        
                                    <button class="action-btn btn-reply" id="save-offer-1plus1">
                                        <i class="fas fa-save"></i> Αποθήκευση Ρυθμίσεων
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Καρτέλα Ειδοποιήσεων -->
                <section id="notifications-tab" class="tab-content">
                    <div class="content-section">
                        <h2><i class="fas fa-bell"></i> Ειδοποιήσεις Ανταλλαγών</h2>
                        
                        <div class="submissions-list" id="notifications-list">
                            <!-- Θα προστεθούν δυναμικά οι ειδοποιήσεις -->
                        </div>
                    </div>
                </section>
            </main>
            
            <footer>
                <p>
                    Καφεμαντεία <span class="coffee-icon">☕</span> 
                    Πίνακας Διαχειριστή
                </p>
                <p>© 2023 - Όλα τα δικαιώματα διατηρούνται</p>
            </footer>
        </div>

        <!-- Modal για προβολή υποβολής -->
        <div class="modal" id="submission-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Προβολή Υποβολής</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-body" id="modal-body">
                    <!-- Θα προστεθεί δυναμικά το περιεχόμενο -->
                </div>
            </div>
        </div>

        <!-- Modal για απάντηση -->
        <div class="modal" id="reply-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Απάντηση στον Χρήστη</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="reply-user-info">
                        <!-- Θα προστεθούν δυναμικά τα στοιχεία του χρήστη -->
                    </div>
                    
                    <div class="reply-form">
                        <div class="form-group">
                            <label for="reply-message">Μήνυμα Απάντησης:</label>
                            <textarea id="reply-message" placeholder="Γράψτε το μήνυμα απάντησής σας εδώ...&#10;&#10;Μπορείτε να επικολλήσετε URLs που θα μετατραπούν αυτόματα σε clickable links για τον χρήστη."></textarea>
                        </div>
                        
                        <div class="url-preview" id="url-preview" style="display: none;">
                            <h4>Προεπισκόπηση URLs:</h4>
                            <div id="url-preview-content"></div>
                        </div>
                        
                        <div class="modal-actions">
                            <button class="action-btn btn-view" id="cancel-reply">
                                <i class="fas fa-times"></i> Ακύρωση
                            </button>
                            <button class="action-btn btn-reply" id="send-reply">
                                <i class="fas fa-paper-plane"></i> Αποστολή Απάντησης
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal για διαχείριση πόντων -->
        <div class="modal" id="points-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Διαχείριση Πόντων Χρήστη</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="points-user-info">
                        <!-- Θα προστεθούν δυναμικά τα στοιχεία του χρήστη -->
                    </div>
                    
                    <div class="points-management">
                        <div class="form-group">
                            <label for="current-points">Τρέχοντες Πόντοι:</label>
                            <input type="number" id="current-points" class="filter-select" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label for="points-action">Ενέργεια:</label>
                            <select class="filter-select" id="points-action">
                                <option value="add">Προσθήκη Πόντων</option>
                                <option value="remove">Αφαίρεση Πόντων</option>
                                <option value="set">Ορισμός Πόντων</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="points-amount">Ποσότητα Πόντων:</label>
                            <input type="number" id="points-amount" class="filter-select" min="0" value="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="points-reason">Αιτιολογία (προαιρετικά):</label>
                            <textarea id="points-reason" placeholder="Προσθέστε μια σύντομη αιτιολογία για την αλλαγή των πόντων..."></textarea>
                        </div>
                        
                        <div class="modal-actions">
                            <button class="action-btn btn-view" id="cancel-points">
                                <i class="fas fa-times"></i> Ακύρωση
                            </button>
                            <button class="action-btn btn-reply" id="save-points">
                                <i class="fas fa-save"></i> Αποθήκευση Αλλαγών
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal επιτυχίας αποστολής -->
        <div class="modal" id="success-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Επιτυχία!</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="success-animation">
                        <i class="fas fa-check-circle"></i>
                        <h3>Το μήνυμα στάλθηκε επιτυχώς!</h3>
                        <p>Ο χρήστης θα ενημερωθεί για την απάντησή σας.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Βελτιωμένη ειδοποίηση -->
        <div class="notification-toast" id="notification-toast">
            <div class="notification-icon">
                <i class="fas fa-bell"></i>
            </div>
            <div class="notification-content">
                <div class="notification-title" id="notification-title">Νέα Ειδοποίηση</div>
                <div class="notification-message" id="notification-message">Έχετε νέα μηνύματα</div>
            </div>
            <button class="notification-close" id="notification-close">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Ηχητική ειδοποίηση -->
        <audio id="notification-sound" class="sound-notification">
            <source src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" type="audio/mpeg">
        </audio>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC4RYDqSqYz7QZqY4qY4qY4qY4qY4qY4qY4",
            authDomain: "cofedium-admin.firebaseapp.com",
            projectId: "cofedium-admin",
            storageBucket: "cofedium-admin.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdef123456"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        document.addEventListener('DOMContentLoaded', function() {
            // Firebase Authentication State Observer
            auth.onAuthStateChanged((user) => {
                if (user) {
                    // User is signed in
                    showMainApp(user.email);
                    loadAllData();
                    setupRealTimeListeners();
                } else {
                    // User is signed out
                    showLoginModal();
                }
            });

            // Σύστημα Αυθεντικοποίησης
            const loginModal = document.getElementById('login-modal');
            const mainContent = document.getElementById('main-content');
            const adminLoginBtn = document.getElementById('admin-login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const adminEmailInput = document.getElementById('admin-email');
            const adminPasswordInput = document.getElementById('admin-password');
            const rememberMeCheckbox = document.getElementById('remember-me');
            const firstTimeSetup = document.getElementById('first-time-setup');
            const adminNameSpan = document.getElementById('admin-name');

            // Εμφάνιση login modal
            function showLoginModal() {
                loginModal.style.display = 'flex';
                mainContent.style.display = 'none';
            }

            // Εμφάνιση κύριας εφαρμογής
            function showMainApp(email) {
                loginModal.style.display = 'none';
                mainContent.style.display = 'block';
                adminNameSpan.textContent = email.split('@')[0];
                
                // Αρχικοποίηση κύριας εφαρμογής
                initializeMainApp();
            }

            // Σύνδεση διαχειριστή
            adminLoginBtn.addEventListener('click', function() {
                const email = adminEmailInput.value.trim();
                const password = adminPasswordInput.value.trim();

                if (!email || !password) {
                    alert('Παρακαλώ συμπληρώστε όλα τα πεδία.');
                    return;
                }

                adminLoginBtn.disabled = true;
                adminLoginBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Σύνδεση...';

                // Firebase Authentication
                auth.signInWithEmailAndPassword(email, password)
                    .then((userCredential) => {
                        showToast('Επιτυχής σύνδεση!', 'success');
                    })
                    .catch((error) => {
                        // Αν η σύνδεση αποτύχει, προσπάθησε να δημιουργήσεις νέο λογαριασμό
                        if (error.code === 'auth/user-not-found') {
                            auth.createUserWithEmailAndPassword(email, password)
                                .then((userCredential) => {
                                    showToast('Δημιουργία νέου λογαριασμού διαχειριστή!', 'success');
                                })
                                .catch((error) => {
                                    console.error('Σφάλμα δημιουργίας λογαριασμού:', error);
                                    alert('Σφάλμα δημιουργίας λογαριασμού: ' + error.message);
                                });
                        } else {
                            console.error('Σφάλμα σύνδεσης:', error);
                            alert('Σφάλμα σύνδεσης: ' + error.message);
                        }
                    })
                    .finally(() => {
                        adminLoginBtn.disabled = false;
                        adminLoginBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Σύνδεση';
                    });
            });

            // Αποσύνδεση
            logoutBtn.addEventListener('click', function() {
                if (confirm('Είστε σίγουρος ότι θέλετε να αποσυνδεθείτε;')) {
                    auth.signOut();
                    showToast('Αποσυνδεθήκατε επιτυχώς.', 'info');
                }
            });

            // Enter key για login
            adminPasswordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    adminLoginBtn.click();
                }
            });

            // Συναρτήσεις Κύριας Εφαρμογής
            function initializeMainApp() {
                // Σύνδεση με την κύρια εφαρμογή
                document.getElementById('mainAppBtn').addEventListener('click', function() {
                    window.location.href = 'index.html';
                });

                // Συγχρονισμός χρηστών
                document.getElementById('syncUsersBtn').addEventListener('click', function() {
                    loadAllData();
                    showToast('Ο συγχρονισμός ολοκληρώθηκε!', 'success');
                });

                // Σύστημα καρτελών
                const tabs = document.querySelectorAll('.tab');
                const tabContents = document.querySelectorAll('.tab-content');
                
                tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        const tabId = tab.getAttribute('data-tab');
                        
                        // Απενεργοποίηση όλων των καρτελών
                        tabs.forEach(t => t.classList.remove('active'));
                        tabContents.forEach(tc => tc.classList.remove('active'));
                        
                        // Ενεργοποίηση της επιλεγμένης καρτέλας
                        tab.classList.add('active');
                        document.getElementById(tabId).classList.add('active');

                        // Αν είναι η καρτέλα ειδοποιήσεων, φόρτωσε τις ειδοποιήσεις
                        if (tabId === 'notifications-tab') {
                            loadNotifications();
                        }
                        
                        // Αν είναι η καρτέλα προσφορών, φόρτωσε τη διαχείριση προσφορών
                        if (tabId === 'offers-tab') {
                            loadOffersManagement();
                        }
                    });
                });
                
                // Φόρτωση όλων των δεδομένων
                function loadAllData() {
                    loadPhotoSubmissions();
                    loadMessageSubmissions();
                    loadUsers();
                    loadOffersManagement();
                    loadNotifications();
                    updateStats();
                }

                // Real-time listeners για Firebase
                function setupRealTimeListeners() {
                    // Real-time για υποβολές
                    db.collection('submissions').onSnapshot((snapshot) => {
                        loadPhotoSubmissions();
                        loadMessageSubmissions();
                        updateStats();
                    });

                    // Real-time για χρήστες
                    db.collection('users').onSnapshot((snapshot) => {
                        loadUsers();
                        updateStats();
                    });

                    // Real-time για ειδοποιήσεις
                    db.collection('notifications').onSnapshot((snapshot) => {
                        loadNotifications();
                        updateStats();
                    });
                }
                
                // Φόρτωση υποβολών φωτογραφιών από Firebase
                function loadPhotoSubmissions() {
                    const listContainer = document.getElementById('photo-submissions-list');
                    
                    db.collection('submissions')
                        .where('type', '==', 'photo')
                        .orderBy('date', 'desc')
                        .get()
                        .then((querySnapshot) => {
                            if (querySnapshot.empty) {
                                listContainer.innerHTML = `
                                    <div class="empty-state">
                                        <div class="empty-icon">
                                            <i class="fas fa-images"></i>
                                        </div>
                                        <h3>Δεν βρέθηκαν υποβολές φωτογραφιών</h3>
                                        <p>Δεν υπάρχουν διαθέσιμες υποβολές προς το παρόν.</p>
                                    </div>
                                `;
                                return;
                            }
                            
                            listContainer.innerHTML = '';
                            
                            querySnapshot.forEach((doc) => {
                                const submission = { id: doc.id, ...doc.data() };
                                const statusClass = `status-${submission.status || 'pending'}`;
                                const statusText = getStatusText(submission.status || 'pending');
                                
                                const photosHTML = submission.photos && submission.photos.length > 0 ? 
                                    submission.photos.map((photo, index) => `
                                        <div class="photo-item">
                                            <img src="${photo.data}" alt="Φωτογραφία καφέ" class="photo-image">
                                        </div>
                                    `).join('') : '<p>Δεν υπάρχουν φωτογραφίες</p>';
                                
                                // Βελτιωμένη εμφάνιση πληροφοριών καφεμαντείας
                                const coffeeReadingInfo = submission.coffeeTypeText ? `
                                    <div class="coffee-reading-info">
                                        <p><strong>Τύπος Καφεμαντείας:</strong> ${submission.coffeeTypeText}</p>
                                        <p><strong>Email Χρήστη:</strong> ${submission.userEmail || submission.email || 'Δεν παρέχεται'}</p>
                                        ${submission.desire ? `<p><strong>Επιθυμία Χρήστη:</strong> ${submission.desire}</p>` : ''}
                                    </div>
                                ` : '';
                                
                                // Πληροφορίες επιλεγμένου καφεμάντη
                                const fortuneTellerInfo = submission.fortuneTellerName ? `
                                    <div class="fortune-teller-info">
                                        <p><strong>Επιλεγμένος Καφεμάντης:</strong> ${submission.fortuneTellerName}</p>
                                        ${submission.fortuneTellerId ? `<p><strong>ID Καφεμάντη:</strong> ${submission.fortuneTellerId}</p>` : ''}
                                    </div>
                                ` : '';
                                
                                const submissionCard = document.createElement('div');
                                submissionCard.className = 'submission-card';
                                submissionCard.innerHTML = `
                                    <div class="submission-header">
                                        <div class="submission-user">${submission.userEmail || submission.email || 'Άγνωστος Χρήστης'}</div>
                                        <div class="submission-date">${formatDate(submission.date)}</div>
                                        <div class="submission-status ${statusClass}">${statusText}</div>
                                    </div>
                                    
                                    ${fortuneTellerInfo}
                                    ${coffeeReadingInfo}
                                    
                                    <div class="submission-content">
                                        <div class="submission-message">
                                            ${submission.message || 'Δεν υπάρχει μήνυμα'}
                                        </div>
                                        
                                        <div class="photos-grid">
                                            ${photosHTML}
                                        </div>
                                    </div>
                                    
                                    <div class="submission-actions">
                                        <button class="action-btn btn-view" data-id="${submission.id}">
                                            <i class="fas fa-eye"></i> Προβολή
                                        </button>
                                        <button class="action-btn btn-reply" data-id="${submission.id}">
                                            <i class="fas fa-reply"></i> Απάντηση
                                        </button>
                                        ${submission.photos && submission.photos.length > 0 ? `
                                        <button class="action-btn btn-download" data-id="${submission.id}">
                                            <i class="fas fa-download"></i> Λήψη
                                        </button>
                                        ` : ''}
                                        <button class="action-btn btn-delete" data-id="${submission.id}">
                                            <i class="fas fa-trash"></i> Διαγραφή
                                        </button>
                                    </div>
                                `;
                                
                                listContainer.appendChild(submissionCard);
                            });
                            
                            // Προσθήκη event listeners για τα κουμπιά
                            addActionEventListeners();
                        })
                        .catch((error) => {
                            console.error('Σφάλμα φόρτωσης υποβολών:', error);
                            listContainer.innerHTML = `
                                <div class="empty-state">
                                    <div class="empty-icon">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <h3>Σφάλμα φόρτωσης δεδομένων</h3>
                                    <p>Παρακαλώ δοκιμάστε ξανά.</p>
                                </div>
                            `;
                        });
                }
                
                // Φόρτωση μηνυμάτων επικοινωνίας από Firebase
                function loadMessageSubmissions() {
                    const listContainer = document.getElementById('message-submissions-list');
                    
                    db.collection('submissions')
                        .where('type', '==', 'message')
                        .orderBy('date', 'desc')
                        .get()
                        .then((querySnapshot) => {
                            if (querySnapshot.empty) {
                                listContainer.innerHTML = `
                                    <div class="empty-state">
                                        <div class="empty-icon">
                                            <i class="fas fa-envelope"></i>
                                        </div>
                                        <h3>Δεν βρέθηκαν μηνύματα</h3>
                                        <p>Δεν υπάρχουν διαθέσιμα μηνύματα προς το παρόν.</p>
                                    </div>
                                `;
                                return;
                            }
                            
                            listContainer.innerHTML = '';
                            
                            querySnapshot.forEach((doc) => {
                                const submission = { id: doc.id, ...doc.data() };
                                const statusClass = `status-${submission.status || 'pending'}`;
                                const statusText = getStatusText(submission.status || 'pending');
                                
                                const submissionCard = document.createElement('div');
                                submissionCard.className = 'submission-card';
                                submissionCard.innerHTML = `
                                    <div class="submission-header">
                                        <div>
                                            <div class="submission-user">${submission.userName || 'Άγνωστος Χρήστης'}</div>
                                            <div class="submission-date">${submission.userEmail || submission.email || 'Χωρίς email'}</div>
                                        </div>
                                        <div class="submission-date">${formatDate(submission.date)}</div>
                                        <div class="submission-status ${statusClass}">${statusText}</div>
                                    </div>
                                    
                                    <div class="submission-content">
                                        <div><strong>Θέμα:</strong> ${submission.subject || 'Χωρίς θέμα'}</div>
                                        <div class="submission-message">${submission.message || 'Δεν υπάρχει μήνυμα'}</div>
                                    </div>
                                    
                                    <div class="submission-actions">
                                        <button class="action-btn btn-view" data-id="${submission.id}">
                                            <i class="fas fa-eye"></i> Προβολή
                                        </button>
                                        <button class="action-btn btn-reply" data-id="${submission.id}">
                                            <i class="fas fa-reply"></i> Απάντηση
                                        </button>
                                        <button class="action-btn btn-delete" data-id="${submission.id}">
                                            <i class="fas fa-trash"></i> Διαγραφή
                                        </button>
                                    </div>
                                `;
                                
                                listContainer.appendChild(submissionCard);
                            });
                            
                            // Προσθήκη event listeners για τα κουμπιά
                            addActionEventListeners();
                        })
                        .catch((error) => {
                            console.error('Σφάλμα φόρτωσης μηνυμάτων:', error);
                            listContainer.innerHTML = `
                                <div class="empty-state">
                                    <div class="empty-icon">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <h3>Σφάλμα φόρτωσης δεδομένων</h3>
                                    <p>Παρακαλώ δοκιμάστε ξανά.</p>
                                </div>
                            `;
                        });
                }
                
                // Φόρτωση χρηστών από Firebase
                function loadUsers() {
                    const listContainer = document.getElementById('users-list');
                    
                    db.collection('users')
                        .orderBy('registrationDate', 'desc')
                        .get()
                        .then((querySnapshot) => {
                            if (querySnapshot.empty) {
                                listContainer.innerHTML = `
                                    <div class="empty-state">
                                        <div class="empty-icon">
                                            <i class="fas fa-users"></i>
                                        </div>
                                        <h3>Δεν βρέθηκαν εγγεγραμμένοι χρήστες</h3>
                                        <p>Δεν υπάρχουν εγγεγραμμένοι χρήστες προς το παρόν.</p>
                                    </div>
                                `;
                                return;
                            }
                            
                            let usersHTML = `
                                <table class="users-table">
                                    <thead>
                                        <tr>
                                            <th>Όνομα</th>
                                            <th>Email</th>
                                            <th>Πόντοι</th>
                                            <th>Επίπεδο</th>
                                            <th>Ημερομηνία Εγγραφής</th>
                                            <th>Ενέργειες</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                            `;
                            
                            querySnapshot.forEach((doc) => {
                                const user = { id: doc.id, ...doc.data() };
                                const userCategory = getUserCategory(user.points || 0);
                                
                                usersHTML += `
                                    <tr>
                                        <td>${user.name || 'Χωρίς όνομα'}</td>
                                        <td>${user.email}</td>
                                        <td>${user.points || 0}</td>
                                        <td>${user.level || 'Αρχάριος'} <span class="user-category ${userCategory.class}">${userCategory.name}</span></td>
                                        <td>${formatDate(user.registrationDate)}</td>
                                        <td>
                                            <div class="user-actions">
                                                <button class="action-btn btn-view view-user" data-id="${user.id}" data-email="${user.email}">
                                                    <i class="fas fa-eye"></i> Προβολή
                                                </button>
                                                <button class="action-btn btn-reply manage-points" data-id="${user.id}" data-email="${user.email}">
                                                    <i class="fas fa-coins"></i> Πόντοι
                                                </button>
                                                <button class="action-btn btn-delete delete-user" data-id="${user.id}" data-email="${user.email}">
                                                    <i class="fas fa-trash"></i> Διαγραφή
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                `;
                            });
                            
                            usersHTML += `
                                    </tbody>
                                </table>
                            `;
                            
                            listContainer.innerHTML = usersHTML;
                            
                            // Προσθήκη event listeners για τα κουμπιά χρηστών
                            document.querySelectorAll('.view-user').forEach(btn => {
                                btn.addEventListener('click', function() {
                                    const userId = this.getAttribute('data-id');
                                    const userEmail = this.getAttribute('data-email');
                                    viewUser(userId, userEmail);
                                });
                            });
                            
                            document.querySelectorAll('.manage-points').forEach(btn => {
                                btn.addEventListener('click', function() {
                                    const userId = this.getAttribute('data-id');
                                    const userEmail = this.getAttribute('data-email');
                                    manageUserPoints(userId, userEmail);
                                });
                            });
                            
                            document.querySelectorAll('.delete-user').forEach(btn => {
                                btn.addEventListener('click', function() {
                                    const userId = this.getAttribute('data-id');
                                    const userEmail = this.getAttribute('data-email');
                                    deleteUser(userId, userEmail);
                                });
                            });
                        })
                        .catch((error) => {
                            console.error('Σφάλμα φόρτωσης χρηστών:', error);
                            listContainer.innerHTML = `
                                <div class="empty-state">
                                    <div class="empty-icon">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <h3>Σφάλμα φόρτωσης δεδομένων</h3>
                                    <p>Παρακαλώ δοκιμάστε ξανά.</p>
                                </div>
                            `;
                        });
                }

                // Κατηγοριοποίηση χρηστών βάσει πόντων
                function getUserCategory(points) {
                    if (points < 50) {
                        return { class: 'category-beginner', name: 'Αρχάριος' };
                    } else if (points < 150) {
                        return { class: 'category-regular', name: 'Τακτικός' };
                    } else if (points < 300) {
                        return { class: 'category-vip', name: 'VIP' };
                    } else {
                        return { class: 'category-master', name: 'Master' };
                    }
                }

                // Φόρτωση διαχείρισης προσφορών από Firebase
                function loadOffersManagement() {
                    db.collection('offers').doc('1plus1').get()
                        .then((doc) => {
                            if (doc.exists) {
                                const offer = doc.data();
                                document.getElementById('offer-1plus1-status').value = offer.active ? 'active' : 'inactive';
                                
                                // Έλεγχος αν η προσφορά έχει λήξει
                                if (offer.expiry && new Date() > new Date(offer.expiry)) {
                                    db.collection('offers').doc('1plus1').update({ active: false });
                                    document.getElementById('offer-1plus1-status').value = 'inactive';
                                }
                            }
                        })
                        .catch((error) => {
                            console.error('Σφάλμα φόρτωσης προσφορών:', error);
                        });
                }

                // Αποθήκευση ρυθμίσεων προσφοράς στο Firebase
                document.getElementById('save-offer-1plus1').addEventListener('click', function() {
                    const status = document.getElementById('offer-1plus1-status').value;
                    const duration = parseInt(document.getElementById('offer-1plus1-duration').value);
                    
                    const active = status === 'active';
                    let expiry = null;
                    
                    if (active) {
                        const expiryDate = new Date();
                        expiryDate.setHours(expiryDate.getHours() + duration);
                        expiry = expiryDate.toISOString();
                    }
                    
                    db.collection('offers').doc('1plus1').set({
                        active: active,
                        expiry: expiry,
                        duration: duration,
                        lastUpdated: new Date().toISOString()
                    }, { merge: true })
                    .then(() => {
                        showToast(`Η προσφορά 1+1 ${active ? 'ενεργοποιήθηκε' : 'απενεργοποιήθηκε'}!`, 'success');
                    })
                    .catch((error) => {
                        console.error('Σφάλμα αποθήκευσης προσφοράς:', error);
                        showToast('Σφάλμα αποθήκευσης προσφοράς!', 'error');
                    });
                });

                // Φόρτωση ειδοποιήσεων από Firebase
                function loadNotifications() {
                    const listContainer = document.getElementById('notifications-list');
                    const badge = document.getElementById('notificationsBadge');
                    
                    db.collection('notifications')
                        .orderBy('date', 'desc')
                        .get()
                        .then((querySnapshot) => {
                            // Ενημέρωση badge
                            const pendingNotifications = querySnapshot.docs.filter(doc => 
                                doc.data().status === 'pending'
                            );
                            
                            if (pendingNotifications.length > 0) {
                                badge.textContent = pendingNotifications.length;
                                badge.style.display = 'flex';
                            } else {
                                badge.style.display = 'none';
                            }
                            
                            if (querySnapshot.empty) {
                                listContainer.innerHTML = `
                                    <div class="empty-state">
                                        <div class="empty-icon">
                                            <i class="fas fa-bell-slash"></i>
                                        </div>
                                        <h3>Δεν υπάρχουν ειδοποιήσεις</h3>
                                        <p>Όλες οι ειδοποιήσεις έχουν επεξεργαστεί.</p>
                                    </div>
                                `;
                                return;
                            }
                            
                            listContainer.innerHTML = '';
                            
                            querySnapshot.forEach((doc) => {
                                const notification = { id: doc.id, ...doc.data() };
                                const statusClass = `status-${notification.status || 'pending'}`;
                                const statusText = getNotificationStatusText(notification.status || 'pending');
                                
                                const notificationCard = document.createElement('div');
                                notificationCard.className = 'submission-card';
                                notificationCard.innerHTML = `
                                    <div class="submission-header">
                                        <div class="submission-user">${notification.userName || notification.userEmail || 'Άγνωστος Χρήστης'}</div>
                                        <div class="submission-date">${formatDate(notification.date)}</div>
                                        <div class="submission-status ${statusClass}">${statusText}</div>
                                    </div>
                                    
                                    <div class="submission-content">
                                        <div class="submission-message">
                                            <strong>Τύπος:</strong> ${getNotificationTypeText(notification.type)}<br>
                                            ${notification.coffeeTypeText ? `<strong>Τύπος Καφεμαντείας:</strong> ${notification.coffeeTypeText}<br>` : ''}
                                            ${notification.desire ? `<strong>Επιθυμία Χρήστη:</strong> ${notification.desire}<br>` : ''}
                                            ${notification.offerTitle ? `<strong>Προσφορά:</strong> ${notification.offerTitle}<br>` : ''}
                                            ${notification.character ? `<strong>Επιλεγμένος Χαρακτήρας:</strong> ${notification.character}<br>` : ''}
                                            <strong>Χρήστης:</strong> ${notification.userEmail || 'Χωρίς email'}
                                        </div>
                                    </div>
                                    
                                    <div class="submission-actions">
                                        <button class="action-btn btn-view view-notification" data-id="${notification.id}">
                                            <i class="fas fa-eye"></i> Προβολή
                                        </button>
                                        ${notification.status === 'pending' ? `
                                        <button class="action-btn btn-reply mark-processed" data-id="${notification.id}">
                                            <i class="fas fa-check"></i> Επεξεργασμένη
                                        </button>
                                        ` : ''}
                                        <button class="action-btn btn-delete delete-notification" data-id="${notification.id}">
                                            <i class="fas fa-trash"></i> Διαγραφή
                                        </button>
                                    </div>
                                `;
                                
                                listContainer.appendChild(notificationCard);
                            });
                            
                            // Προσθήκη event listeners για ειδοποιήσεις
                            document.querySelectorAll('.view-notification').forEach(btn => {
                                btn.addEventListener('click', function() {
                                    const notificationId = this.getAttribute('data-id');
                                    viewNotification(notificationId);
                                });
                            });
                            
                            document.querySelectorAll('.mark-processed').forEach(btn => {
                                btn.addEventListener('click', function() {
                                    const notificationId = this.getAttribute('data-id');
                                    markNotificationProcessed(notificationId);
                                });
                            });
                            
                            document.querySelectorAll('.delete-notification').forEach(btn => {
                                btn.addEventListener('click', function() {
                                    const notificationId = this.getAttribute('data-id');
                                    deleteNotification(notificationId);
                                });
                            });
                        })
                        .catch((error) => {
                            console.error('Σφάλμα φόρτωσης ειδοποιήσεων:', error);
                            listContainer.innerHTML = `
                                <div class="empty-state">
                                    <div class="empty-icon">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <h3>Σφάλμα φόρτωσης δεδομένων</h3>
                                    <p>Παρακαλώ δοκιμάστε ξανά.</p>
                                </div>
                            `;
                        });
                }
                
                // Βοηθητικές συναρτήσεις
                function getStatusText(status) {
                    const statusMap = {
                        'pending': 'Σε Εκκρεμότητα',
                        'reviewed': 'Εξετασμένη',
                        'answered': 'Απαντημένη'
                    };
                    return statusMap[status] || status;
                }

                function getNotificationStatusText(status) {
                    const statusMap = {
                        'pending': 'Σε Εκκρεμότητα',
                        'processed': 'Επεξεργασμένη'
                    };
                    return statusMap[status] || status;
                }

                function getNotificationTypeText(type) {
                    const typeMap = {
                        'offer_redemption': 'Ανταλλαγή Προσφοράς',
                        'coffee_reading': 'Υποβολή Καφεμαντείας',
                        'character_selection': 'Επιλογή Χαρακτήρα'
                    };
                    return typeMap[type] || type;
                }
                
                function formatDate(dateString) {
                    try {
                        if (!dateString) return 'Άγνωστη ημερομηνία';
                        const options = { 
                            year: 'numeric', 
                            month: 'short', 
                            day: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        };
                        return new Date(dateString).toLocaleDateString('el-GR', options);
                    } catch (e) {
                        return 'Άγνωστη ημερομηνία';
                    }
                }
                
                // Προσθήκη event listeners για ενέργειες
                function addActionEventListeners() {
                    // Προβολή υποβολής
                    document.querySelectorAll('.btn-view').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const submissionId = this.getAttribute('data-id');
                            viewSubmission(submissionId);
                        });
                    });
                    
                    // Απάντηση
                    document.querySelectorAll('.btn-reply').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const submissionId = this.getAttribute('data-id');
                            openReplyModal(submissionId);
                        });
                    });
                    
                    // Λήψη φωτογραφιών
                    document.querySelectorAll('.btn-download').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const submissionId = this.getAttribute('data-id');
                            downloadSubmission(submissionId);
                        });
                    });
                    
                    // Διαγραφή
                    document.querySelectorAll('.btn-delete').forEach(btn => {
                        btn.addEventListener('click', function() {
                            const submissionId = this.getAttribute('data-id');
                            deleteSubmission(submissionId);
                        });
                    });
                }
                
                // Λειτουργίες modal
                const submissionModal = document.getElementById('submission-modal');
                const replyModal = document.getElementById('reply-modal');
                const pointsModal = document.getElementById('points-modal');
                const successModal = document.getElementById('success-modal');
                const closeModalButtons = document.querySelectorAll('.close-modal');
                
                // Κλείσιμο modal
                closeModalButtons.forEach(btn => {
                    btn.addEventListener('click', function() {
                        submissionModal.style.display = 'none';
                        replyModal.style.display = 'none';
                        pointsModal.style.display = 'none';
                        successModal.style.display = 'none';
                    });
                });
                
                // Κλείσιμο modal με κλικ έξω από το περιεχόμενο
                window.addEventListener('click', function(event) {
                    if (event.target === submissionModal) {
                        submissionModal.style.display = 'none';
                    }
                    if (event.target === replyModal) {
                        replyModal.style.display = 'none';
                    }
                    if (event.target === pointsModal) {
                        pointsModal.style.display = 'none';
                    }
                    if (event.target === successModal) {
                        successModal.style.display = 'none';
                    }
                });
                
                // Προβολή υποβολής
                function viewSubmission(id) {
                    db.collection('submissions').doc(id).get()
                        .then((doc) => {
                            if (!doc.exists) return;
                            
                            const submission = { id: doc.id, ...doc.data() };
                            const modalBody = document.getElementById('modal-body');
                            
                            if (submission.type === 'photo') {
                                const photosHTML = submission.photos && submission.photos.length > 0 ? 
                                    submission.photos.map(photo => `
                                        <div class="photo-item">
                                            <img src="${photo.data}" alt="Φωτογραφία καφέ" class="photo-image">
                                        </div>
                                    `).join('') : '<p>Δεν υπάρχουν φωτογραφίες</p>';
                                
                                // Βελτιωμένη εμφάνιση πληροφοριών καφεμαντείας
                                const coffeeReadingInfo = submission.coffeeTypeText ? `
                                    <div class="coffee-reading-info">
                                        <p><strong>Τύπος Καφεμαντείας:</strong> ${submission.coffeeTypeText}</p>
                                        <p><strong>Email Χρήστη:</strong> ${submission.userEmail || submission.email || 'Δεν παρέχεται'}</p>
                                        ${submission.desire ? `<p><strong>Επιθυμία Χρήστη:</strong> ${submission.desire}</p>` : ''}
                                    </div>
                                ` : '';
                                
                                // Πληροφορίες επιλεγμένου καφεμάντη
                                const fortuneTellerInfo = submission.fortuneTellerName ? `
                                    <div class="fortune-teller-info">
                                        <p><strong>Επιλεγμένος Καφεμάντης:</strong> ${submission.fortuneTellerName}</p>
                                        ${submission.fortuneTellerId ? `<p><strong>ID Καφεμάντη:</strong> ${submission.fortuneTellerId}</p>` : ''}
                                    </div>
                                ` : '';
                                
                                modalBody.innerHTML = `
                                    <div class="submission-header">
                                        <div class="submission-user">${submission.userEmail || submission.email || 'Άγνωστος Χρήστης'}</div>
                                        <div class="submission-date">${formatDate(submission.date)}</div>
                                    </div>
                                    
                                    ${fortuneTellerInfo}
                                    ${coffeeReadingInfo}
                                    
                                    <div class="submission-content">
                                        <div class="submission-message">
                                            <strong>Μήνυμα:</strong><br>
                                            ${submission.message || 'Δεν υπάρχει μήνυμα'}
                                        </div>
                                        
                                        <div class="preview-title">
                                            <i class="fas fa-images"></i> Φωτογραφίες:
                                        </div>
                                        <div class="photos-grid">
                                            ${photosHTML}
                                        </div>
                                    </div>
                                `;
                            } else {
                                modalBody.innerHTML = `
                                    <div class="submission-header">
                                        <div>
                                            <div class="submission-user">${submission.userName || 'Άγνωστος Χρήστης'}</div>
                                            <div class="submission-date">${submission.userEmail || submission.email || 'Χωρίς email'}</div>
                                        </div>
                                        <div class="submission-date">${formatDate(submission.date)}</div>
                                    </div>
                                    
                                    <div class="submission-content">
                                        <div><strong>Θέμα:</strong> ${submission.subject || 'Χωρίς θέμα'}</div>
                                        <div class="submission-message">
                                            <strong>Μήνυμα:</strong><br>
                                            ${submission.message || 'Δεν υπάρχει μήνυμα'}
                                        </div>
                                    </div>
                                `;
                            }
                            
                            submissionModal.style.display = 'flex';
                        })
                        .catch((error) => {
                            console.error('Σφάλμα προβολής υποβολής:', error);
                            alert('Σφάλμα φόρτωσης υποβολής!');
                        });
                }
                
                // Προβολή χρήστη
                function viewUser(id, email) {
                    db.collection('users').doc(id).get()
                        .then((doc) => {
                            if (!doc.exists) return;
                            
                            const user = { id: doc.id, ...doc.data() };
                            const modalBody = document.getElementById('modal-body');
                            
                            modalBody.innerHTML = `
                                <div class="submission-header">
                                    <div class="submission-user">${user.name || 'Χωρίς όνομα'}</div>
                                    <div class="submission-date">${formatDate(user.registrationDate)}</div>
                                </div>
                                
                                <div class="submission-content">
                                    <div><strong>Email:</strong> ${user.email}</div>
                                    <div><strong>Πόντοι:</strong> ${user.points || 0}</div>
                                    <div><strong>Επίπεδο:</strong> ${user.level || 'Αρχάριος'}</div>
                                    <div><strong>Ημερομηνία Εγγραφής:</strong> ${formatDate(user.registrationDate)}</div>
                                    <div><strong>ID Χρήστη:</strong> ${user.id}</div>
                                </div>
                            `;
                            
                            submissionModal.style.display = 'flex';
                        })
                        .catch((error) => {
                            console.error('Σφάλμα προβολής χρήστη:', error);
                            alert('Σφάλμα φόρτωσης χρήστη!');
                        });
                }

                // Προβολή ειδοποίησης
                function viewNotification(id) {
                    db.collection('notifications').doc(id).get()
                        .then((doc) => {
                            if (!doc.exists) return;
                            
                            const notification = { id: doc.id, ...doc.data() };
                            const modalBody = document.getElementById('modal-body');
                            
                            modalBody.innerHTML = `
                                <div class="submission-header">
                                    <div class="submission-user">${notification.userName || notification.userEmail || 'Άγνωστος Χρήστης'}</div>
                                    <div class="submission-date">${formatDate(notification.date)}</div>
                                </div>
                                
                                <div class="submission-content">
                                    <div><strong>Τύπος:</strong> ${getNotificationTypeText(notification.type)}</div>
                                    ${notification.coffeeTypeText ? `<div><strong>Τύπος Καφεμαντείας:</strong> ${notification.coffeeTypeText}</div>` : ''}
                                    ${notification.desire ? `<div><strong>Επιθυμία Χρήστη:</strong> ${notification.desire}</div>` : ''}
                                    ${notification.offerTitle ? `<div><strong>Προσφορά:</strong> ${notification.offerTitle}</div>` : ''}
                                    ${notification.character ? `<div><strong>Επιλεγμένος Χαρακτήρας:</strong> ${notification.character}</div>` : ''}
                                    <div><strong>Χρήστης:</strong> ${notification.userEmail || 'Χωρίς email'}</div>
                                    <div><strong>Ημερομηνία:</strong> ${formatDate(notification.date)}</div>
                                    <div><strong>Κατάσταση:</strong> ${getNotificationStatusText(notification.status)}</div>
                                </div>
                            `;
                            
                            submissionModal.style.display = 'flex';
                        })
                        .catch((error) => {
                            console.error('Σφάλμα προβολής ειδοποίησης:', error);
                            alert('Σφάλμα φόρτωσης ειδοποίησης!');
                        });
                }

                // Σήμανση ειδοποίησης ως επεξεργασμένης
                function markNotificationProcessed(id) {
                    db.collection('notifications').doc(id).update({
                        status: 'processed',
                        processedAt: new Date().toISOString()
                    })
                    .then(() => {
                        showToast('Η ειδοποίηση σημάνθηκε ως επεξεργασμένη!', 'success');
                        loadNotifications();
                    })
                    .catch((error) => {
                        console.error('Σφάλμα σήμανσης ειδοποίησης:', error);
                        showToast('Σφάλμα σήμανσης ειδοποίησης!', 'error');
                    });
                }

                // Διαγραφή ειδοποίησης
                function deleteNotification(id) {
                    if (confirm('Είστε σίγουρος ότι θέλετε να διαγράψετε αυτή την ειδοποίηση;')) {
                        db.collection('notifications').doc(id).delete()
                            .then(() => {
                                showToast('Η ειδοποίηση διαγράφηκε επιτυχώς!', 'success');
                                loadNotifications();
                            })
                            .catch((error) => {
                                console.error('Σφάλμα διαγραφής ειδοποίησης:', error);
                                showToast('Σφάλμα διαγραφής ειδοποίησης!', 'error');
                            });
                    }
                }
                
                // Διαχείριση πόντων χρήστη
                function manageUserPoints(userId, userEmail) {
                    db.collection('users').doc(userId).get()
                        .then((doc) => {
                            if (!doc.exists) return;
                            
                            const user = { id: doc.id, ...doc.data() };
                            const pointsUserInfo = document.getElementById('points-user-info');
                            
                            pointsUserInfo.innerHTML = `
                                <div class="submission-header">
                                    <div class="submission-user">${user.name || 'Χωρίς όνομα'}</div>
                                    <div class="submission-date">${user.email}</div>
                                </div>
                                
                                <div class="submission-content">
                                    <div><strong>Τρέχοντες Πόντοι:</strong> ${user.points || 0}</div>
                                    <div><strong>Τρέχον Επίπεδο:</strong> ${user.level || 'Αρχάριος'}</div>
                                </div>
                            `;
                            
                            document.getElementById('current-points').value = user.points || 0;
                            document.getElementById('points-amount').value = 0;
                            document.getElementById('points-reason').value = '';
                            
                            pointsModal.style.display = 'flex';
                            
                            // Αποθήκευση του userId για χρήση στην αποθήκευση
                            document.getElementById('save-points').setAttribute('data-id', userId);
                        })
                        .catch((error) => {
                            console.error('Σφάλμα φόρτωσης χρήστη:', error);
                            alert('Σφάλμα φόρτωσης χρήστη!');
                        });
                }
                
                // Αποθήκευση αλλαγών πόντων
                document.getElementById('save-points').addEventListener('click', function() {
                    const userId = this.getAttribute('data-id');
                    const currentPoints = parseInt(document.getElementById('current-points').value);
                    const action = document.getElementById('points-action').value;
                    const amount = parseInt(document.getElementById('points-amount').value);
                    const reason = document.getElementById('points-reason').value;
                    
                    if (isNaN(amount) || amount < 0) {
                        alert('Παρακαλώ εισάγετε έγκυρη ποσότητα πόντων.');
                        return;
                    }
                    
                    let newPoints = currentPoints;
                    
                    switch(action) {
                        case 'add':
                            newPoints += amount;
                            break;
                        case 'remove':
                            newPoints = Math.max(0, currentPoints - amount);
                            break;
                        case 'set':
                            newPoints = amount;
                            break;
                    }
                    
                    // Ενημέρωση επιπέδου
                    let level = 'Αρχάριος';
                    if (newPoints >= 100) level = 'Ειδικός';
                    if (newPoints >= 300) level = 'Μάστερ';
                    if (newPoints >= 500) level = 'Grand Master';
                    
                    // Ενημέρωση των πόντων του χρήστη
                    db.collection('users').doc(userId).update({
                        points: newPoints,
                        level: level,
                        lastUpdated: new Date().toISOString()
                    })
                    .then(() => {
                        // Καταγραφή της αλλαγής
                        db.collection('pointsHistory').add({
                            userId: userId,
                            action: action,
                            amount: amount,
                            previousPoints: currentPoints,
                            newPoints: newPoints,
                            reason: reason,
                            date: new Date().toISOString(),
                            admin: auth.currentUser.email
                        });
                        
                        showToast(`Οι πόντοι του χρήστη ενημερώθηκαν επιτυχώς! Νέοι πόντοι: ${newPoints}`, 'success');
                        pointsModal.style.display = 'none';
                        loadUsers();
                    })
                    .catch((error) => {
                        console.error('Σφάλμα ενημέρωσης πόντων:', error);
                        showToast('Σφάλμα ενημέρωσης πόντων!', 'error');
                    });
                });
                
                // Ακύρωση διαχείρισης πόντων
                document.getElementById('cancel-points').addEventListener('click', function() {
                    pointsModal.style.display = 'none';
                });
                
                // Νέα λειτουργία για URL detection και preview
                const replyMessageTextarea = document.getElementById('reply-message');
                const urlPreview = document.getElementById('url-preview');
                const urlPreviewContent = document.getElementById('url-preview-content');
                
                // Λειτουργία για ανίχνευση URLs και προεπισκόπηση
                replyMessageTextarea.addEventListener('input', function() {
                    const text = this.value;
                    const urls = extractUrls(text);
                    
                    if (urls.length > 0) {
                        urlPreviewContent.innerHTML = urls.map(url => `
                            <div class="url-item">
                                <i class="fas fa-link"></i>
                                <a href="${url}" target="_blank" class="preview-link">${url}</a>
                                <span class="url-note">(θα ανοίξει σε νέα καρτέλα)</span>
                            </div>
                        `).join('');
                        urlPreview.style.display = 'block';
                    } else {
                        urlPreview.style.display = 'none';
                    }
                });
                
                // Συνάρτηση εξαγωγής URLs από κείμενο
                function extractUrls(text) {
                    const urlRegex = /(https?:\/\/[^\s]+)/g;
                    return text.match(urlRegex) || [];
                }
                
                // Συνάρτηση μετατροπής URLs σε clickable links
                function convertUrlsToLinks(text) {
                    const urlRegex = /(https?:\/\/[^\s]+)/g;
                    return text.replace(urlRegex, function(url) {
                        return `<a href="${url}" target="_blank" class="message-link">${url}</a>`;
                    });
                }
                
                // Άνοιγμα modal απάντησης
                function openReplyModal(id) {
                    db.collection('submissions').doc(id).get()
                        .then((doc) => {
                            if (!doc.exists) return;
                            
                            const submission = { id: doc.id, ...doc.data() };
                            const userInfo = document.getElementById('reply-user-info');
                            
                            if (submission.type === 'photo') {
                                userInfo.innerHTML = `
                                    <div class="submission-header">
                                        <div class="submission-user">Απάντηση σε: ${submission.userEmail || submission.email || 'Άγνωστος Χρήστης'}</div>
                                        <div class="submission-date">${formatDate(submission.date)}</div>
                                    </div>
                                    
                                    <div class="submission-content">
                                        <div class="submission-message">
                                            <strong>Τύπος Καφεμαντείας:</strong> ${submission.coffeeTypeText || 'Γραπτή Ερμηνεία'}<br>
                                            ${submission.fortuneTellerName ? `<strong>Επιλεγμένος Καφεμάντης:</strong> ${submission.fortuneTellerName}<br>` : ''}
                                            ${submission.desire ? `<strong>Επιθυμία Χρήστη:</strong><br>${submission.desire}<br><br>` : ''}
                                            <strong>Αρχικό Μήνυμα:</strong><br>
                                            ${submission.message || 'Δεν υπάρχει μήνυμα'}
                                        </div>
                                    </div>
                                `;
                            } else {
                                userInfo.innerHTML = `
                                    <div class="submission-header">
                                        <div>
                                            <div class="submission-user">Απάντηση σε: ${submission.userName || 'Άγνωστος Χρήστης'}</div>
                                            <div class="submission-date">${submission.userEmail || submission.email || 'Χωρίς email'}</div>
                                        </div>
                                        <div class="submission-date">${formatDate(submission.date)}</div>
                                    </div>
                                    
                                    <div class="submission-content">
                                        <div><strong>Θέμα:</strong> ${submission.subject || 'Χωρίς θέμα'}</div>
                                        <div class="submission-message">
                                            <strong>Αρχικό Μήνυμα:</strong><br>
                                            ${submission.message || 'Δεν υπάρχει μήνυμα'}
                                        </div>
                                    </div>
                                `;
                            }
                            
                            document.getElementById('reply-message').value = '';
                            urlPreview.style.display = 'none';
                            replyModal.style.display = 'flex';
                            
                            // Αποθήκευση του ID για χρήση στην αποστολή
                            document.getElementById('send-reply').setAttribute('data-id', id);
                        })
                        .catch((error) => {
                            console.error('Σφάλμα φόρτωσης υποβολής:', error);
                            alert('Σφάλμα φόρτωσης υποβολής!');
                        });
                }
                
                // Αποστολή απάντησης
                document.getElementById('send-reply').addEventListener('click', function() {
                    const replyMessage = document.getElementById('reply-message').value;
                    const submissionId = this.getAttribute('data-id');
                    
                    if (!replyMessage.trim()) {
                        alert('Παρακαλώ εισάγετε μήνυμα απάντησης.');
                        return;
                    }
                    
                    // Μετατροπή URLs σε links
                    const formattedMessage = convertUrlsToLinks(replyMessage);
                    
                    // Βρες την υποβολή
                    db.collection('submissions').doc(submissionId).get()
                        .then((doc) => {
                            if (!doc.exists) {
                                alert('Δεν βρέθηκε η υποβολή!');
                                return;
                            }
                            
                            const submission = doc.data();
                            
                            // Δημιουργία απάντησης
                            const response = {
                                submissionId: submissionId,
                                userEmail: submission.userEmail || submission.email,
                                adminMessage: formattedMessage,
                                originalMessage: submission.message || submission.subject,
                                fortuneTellerName: submission.fortuneTellerName,
                                date: new Date().toISOString(),
                                status: 'sent',
                                adminUser: auth.currentUser.email
                            };
                            
                            // Αποθήκευση απάντησης
                            return db.collection('responses').add(response);
                        })
                        .then(() => {
                            // Ενημέρωση κατάστασης υποβολής
                            return db.collection('submissions').doc(submissionId).update({
                                status: 'answered',
                                answeredAt: new Date().toISOString()
                            });
                        })
                        .then(() => {
                            // Αποστολή
                            this.disabled = true;
                            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Αποστολή...';
                            
                            setTimeout(() => {
                                // Αναπαραγωγή ήχου
                                playNotificationSound();
                                
                                // Κλείσιμο modal απάντησης
                                replyModal.style.display = 'none';
                                
                                // Εμφάνιση modal επιτυχίας
                                successModal.style.display = 'flex';
                                
                                // Επαναφορά κουμπιού
                                this.disabled = false;
                                this.innerHTML = '<i class="fas fa-paper-plane"></i> Αποστολή Απάντησης';
                                
                                // Ανανέωση δεδομένων
                                loadAllData();
                                
                                // Αυτόματο κλείσιμο modal επιτυχίας μετά από 3 δευτερόλεπτα
                                setTimeout(() => {
                                    successModal.style.display = 'none';
                                }, 3000);
                            }, 1500);
                        })
                        .catch((error) => {
                            console.error('Σφάλμα αποστολής απάντησης:', error);
                            alert('Σφάλμα αποστολής απάντησης!');
                            this.disabled = false;
                            this.innerHTML = '<i class="fas fa-paper-plane"></i> Αποστολή Απάντησης';
                        });
                });
                
                // Αναπαραγωγή ήχου ειδοποίησης
                function playNotificationSound() {
                    const sound = document.getElementById('notification-sound');
                    sound.play().catch(e => {
                        console.log('Αποτυχία αναπαραγωγής ήχου:', e);
                    });
                }
                
                // Ακύρωση απάντησης
                document.getElementById('cancel-reply').addEventListener('click', function() {
                    replyModal.style.display = 'none';
                });
                
                // Λήψη υποβολής
                function downloadSubmission(id) {
                    db.collection('submissions').doc(id).get()
                        .then((doc) => {
                            if (!doc.exists) return;
                            
                            const submission = doc.data();
                            
                            if (submission.type === 'photo' && submission.photos && submission.photos.length > 0) {
                                // Δημιουργία ZIP με τις φωτογραφίες (θα γινόταν στην πραγματικότητα)
                                alert(`Λήψη ${submission.photos.length} φωτογραφιών από τον χρήστη ${submission.userEmail || submission.email}`);
                            } else {
                                alert('Δεν βρέθηκαν φωτογραφίες για λήψη');
                            }
                        })
                        .catch((error) => {
                            console.error('Σφάλμα λήψης υποβολής:', error);
                            alert('Σφάλμα λήψης υποβολής!');
                        });
                }
                
                // Διαγραφή υποβολής
                function deleteSubmission(id) {
                    if (confirm('Είστε σίγουρος ότι θέλετε να διαγράψετε αυτή την υποβολή;')) {
                        db.collection('submissions').doc(id).delete()
                            .then(() => {
                                showToast('Η υποβολή διαγράφηκε επιτυχώς!', 'success');
                                loadAllData();
                            })
                            .catch((error) => {
                                console.error('Σφάλμα διαγραφής υποβολής:', error);
                                showToast('Σφάλμα διαγραφής υποβολής!', 'error');
                            });
                    }
                }
                
                // Διαγραφή χρήστη
                function deleteUser(userId, userEmail) {
                    if (confirm('Είστε σίγουρος ότι θέλετε να διαγράψετε αυτόν τον χρήστη και όλα τα σχετικά δεδομένα;')) {
                        // Διαγραφή χρήστη
                        db.collection('users').doc(userId).delete()
                            .then(() => {
                                // Διαγραφή υποβολών του χρήστη
                                return db.collection('submissions')
                                    .where('userEmail', '==', userEmail)
                                    .get()
                                    .then((querySnapshot) => {
                                        const batch = db.batch();
                                        querySnapshot.forEach((doc) => {
                                            batch.delete(doc.ref);
                                        });
                                        return batch.commit();
                                    });
                            })
                            .then(() => {
                                // Διαγραφή ειδοποιήσεων του χρήστη
                                return db.collection('notifications')
                                    .where('userEmail', '==', userEmail)
                                    .get()
                                    .then((querySnapshot) => {
                                        const batch = db.batch();
                                        querySnapshot.forEach((doc) => {
                                            batch.delete(doc.ref);
                                        });
                                        return batch.commit();
                                    });
                            })
                            .then(() => {
                                showToast('Ο χρήστης και όλα τα σχετικά δεδομένα διαγράφηκαν επιτυχώς!', 'success');
                                loadAllData();
                            })
                            .catch((error) => {
                                console.error('Σφάλμα διαγραφής χρήστη:', error);
                                showToast('Σφάλμα διαγραφής χρήστη!', 'error');
                            });
                    }
                }
                
                // Ενημέρωση στατιστικών
                function updateStats() {
                    // Συνολικές υποβολές
                    db.collection('submissions').get()
                        .then((querySnapshot) => {
                            document.getElementById('total-submissions').textContent = querySnapshot.size;
                            
                            // Υποβολές σε εκκρεμότητα
                            const pending = querySnapshot.docs.filter(doc => 
                                doc.data().status === 'pending'
                            ).length;
                            document.getElementById('pending-submissions').textContent = pending;
                            
                            // Απαντημένες υποβολές
                            const answered = querySnapshot.docs.filter(doc => 
                                doc.data().status === 'answered'
                            ).length;
                            document.getElementById('answered-submissions').textContent = answered;
                        })
                        .catch((error) => {
                            console.error('Σφάλμα στατιστικών υποβολών:', error);
                        });
                    
                    // Εγγεγραμμένοι χρήστες
                    db.collection('users').get()
                        .then((querySnapshot) => {
                            document.getElementById('registered-users').textContent = querySnapshot.size;
                        })
                        .catch((error) => {
                            console.error('Σφάλμα στατιστικών χρηστών:', error);
                        });
                }
                
                // Βελτιωμένη ειδοποίηση (Toast)
                const notificationToast = document.getElementById('notification-toast');
                const notificationTitle = document.getElementById('notification-title');
                const notificationMessage = document.getElementById('notification-message');
                const notificationClose = document.getElementById('notification-close');
                
                notificationClose.addEventListener('click', function() {
                    notificationToast.classList.remove('show');
                });
                
                function showToast(message, type) {
                    // Ορισμός χρώματος και εικονιδίου ανάλογα με τον τύπο
                    let icon = 'fas fa-bell';
                    let color = 'var(--info)';
                    
                    switch(type) {
                        case 'success':
                            icon = 'fas fa-check-circle';
                            color = 'var(--success)';
                            break;
                        case 'error':
                            icon = 'fas fa-exclamation-circle';
                            color = 'var(--error)';
                            break;
                        case 'warning':
                            icon = 'fas fa-exclamation-triangle';
                            color = 'var(--warning)';
                            break;
                    }
                    
                    // Ενημέρωση περιεχομένου
                    notificationTitle.textContent = type === 'success' ? 'Επιτυχία' : 
                                                   type === 'error' ? 'Σφάλμα' : 
                                                   type === 'warning' ? 'Προσοχή' : 'Ειδοποίηση';
                    notificationMessage.textContent = message;
                    
                    // Ενημέρωση εικονιδίου και χρώματος
                    notificationToast.querySelector('.notification-icon i').className = icon;
                    notificationToast.style.borderLeftColor = color;
                    
                    // Εμφάνιση
                    notificationToast.classList.add('show');
                    
                    // Αυτόματη απόκρυψη μετά από 5 δευτερόλεπτα
                    setTimeout(() => {
                        notificationToast.classList.remove('show');
                    }, 5000);
                }
                
                // Αρχική φόρτωση δεδομένων
                loadAllData();
            }
        });
    </script>
</body>
</html>
