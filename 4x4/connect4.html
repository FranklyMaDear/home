<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connect 4 - 6x6 Grid</title>
    <link rel="stylesheet" href="connect4.css">
</head>
<body>
    <div class="game-container">
        <h1>Connect 4 - 6x6</h1>
        
        <div class="instructions">
            <strong>Πώς παίζεται:</strong> Οι δύο παίκτες εναλλάσσονται τοποθετώντας δίσκους. 
            Ο πρώτος που θα ενώσει 4 δίσκους σε σειρά (οριζόντια, κάθετα ή διαγώνια) κερδίζει!
        </div>
        
        <div class="players">
            <div class="player">
                <div class="player-1-color"></div>
                <span>Παίκτης 1 (Κόκκινο)</span>
            </div>
            <div class="player">
                <div class="player-2-color"></div>
                <span>Παίκτης 2 (Κίτρινο)</span>
            </div>
        </div>
        
        <div class="board-container">
            <div class="board" id="gameBoard">
                <!-- JavaScript will generate the 6x6 board -->
            </div>
            <div class="board-overlay"></div>
        </div>
        
        <div class="status" id="status">Σειρά του Παίκτη 1 (Κόκκινο)</div>
        
        <div class="controls">
            <button onclick="resetGame()">Νέο Παιχνίδι</button>
        </div>
    </div>

    <script>
        let currentPlayer = 1;
        let gameBoard = Array(6).fill().map(() => Array(6).fill(0));
        let gameActive = true;

        function createBoard() {
            const board = document.getElementById('gameBoard');
            board.innerHTML = '';
            
            // Calculate slot size based on container
            const containerWidth = board.clientWidth;
            const slotSize = Math.min((containerWidth - 40) / 6, 70); // Max 70px
            
            // Apply slot size
            board.style.gap = `${slotSize * 0.1}px`;
            
            for (let row = 0; row < 6; row++) {
                for (let col = 0; col < 6; col++) {
                    const slot = document.createElement('div');
                    slot.className = 'slot';
                    slot.dataset.col = col;
                    slot.dataset.row = row;
                    
                    const disc = document.createElement('div');
                    disc.className = 'disc';
                    disc.id = `disc-${col}-${row}`;
                    
                    slot.appendChild(disc);
                    
                    // Add both click and touch events for better mobile support
                    slot.addEventListener('click', () => makeMove(col));
                    slot.addEventListener('touchend', (e) => {
                        e.preventDefault();
                        makeMove(col);
                    });
                    
                    board.appendChild(slot);
                }
            }
        }

        function makeMove(col) {
            if (!gameActive) return;
            
            for (let row = 5; row >= 0; row--) {
                if (gameBoard[col][row] === 0) {
                    gameBoard[col][row] = currentPlayer;
                    
                    const disc = document.getElementById(`disc-${col}-${row}`);
                    disc.classList.add(currentPlayer === 1 ? 'red' : 'yellow');
                    
                    if (checkWin(col, row)) {
                        document.getElementById('status').textContent = 
                            `Ο Παίκτης ${currentPlayer} κέρδισε! 🎉`;
                        gameActive = false;
                        highlightWinningCells(col, row);
                        return;
                    }
                    
                    if (checkDraw()) {
                        document.getElementById('status').textContent = 'Ισοπαλία!';
                        gameActive = false;
                        return;
                    }
                    
                    currentPlayer = currentPlayer === 1 ? 2 : 1;
                    document.getElementById('status').textContent = 
                        `Σειρά του Παίκτη ${currentPlayer} (${currentPlayer === 1 ? 'Κόκκινο' : 'Κίτρινο'})`;
                    return;
                }
            }
        }

        function checkWin(col, row) {
            const player = gameBoard[col][row];
            const directions = [
                [0, 1],  // vertical
                [1, 0],  // horizontal
                [1, 1],  // diagonal down-right
                [1, -1]  // diagonal up-right
            ];
            
            for (const [dx, dy] of directions) {
                let count = 1;
                
                // Check in positive direction
                for (let i = 1; i < 4; i++) {
                    const newCol = col + dx * i;
                    const newRow = row + dy * i;
                    if (newCol >= 0 && newCol < 6 && newRow >= 0 && newRow < 6 && 
                        gameBoard[newCol][newRow] === player) {
                        count++;
                    } else {
                        break;
                    }
                }
                
                // Check in negative direction
                for (let i = 1; i < 4; i++) {
                    const newCol = col - dx * i;
                    const newRow = row - dy * i;
                    if (newCol >= 0 && newCol < 6 && newRow >= 0 && newRow < 6 && 
                        gameBoard[newCol][newRow] === player) {
                        count++;
                    } else {
                        break;
                    }
                }
                
                if (count >= 4) return true;
            }
            
            return false;
        }

        function highlightWinningCells(col, row) {
            // Simple implementation - in a real game you would find and highlight the exact winning line
            setTimeout(() => {
                const slots = document.querySelectorAll('.slot');
                slots.forEach(slot => {
                    slot.style.transition = 'all 0.5s ease';
                    slot.style.transform = 'scale(1.02)';
                });
            }, 500);
        }

        function checkDraw() {
            return gameBoard.every(column => column.every(cell => cell !== 0));
        }

        function resetGame() {
            gameBoard = Array(6).fill().map(() => Array(6).fill(0));
            currentPlayer = 1;
            gameActive = true;
            document.getElementById('status').textContent = 'Σειρά του Παίκτη 1 (Κόκκινο)';
            createBoard();
        }

        // Initialize the game and handle resize
        window.addEventListener('DOMContentLoaded', createBoard);
        window.addEventListener('resize', createBoard);
        
        // Prevent zoom on double tap for mobile devices
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>
