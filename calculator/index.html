<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>iOS Style Calculator</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><rect width='16' height='16' fill='%23000'/><text x='8' y='12' font-family='Arial' font-size='12' fill='%23fff' text-anchor='middle'>=</text></svg>">
    <style>
    /* ο υπόλοιπος CSS κώδικας */
    
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Calculator</title>
<style>
:root {
--bg: #000000;
--btn-dark: #333333;
--btn-grey: #a6a6a6;
--btn-orange: #ff9500;
--display-color: #ffffff;
--gap: 12px;
--font-size-btn: 48px;
--font-size-op: 52px;
}

body {
margin: 0;
background: var(--bg);
font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
color: var(--display-color);
display: flex;
justify-content: center;
align-items: flex-end;
height: 100vh;
flex-direction: column;
-webkit-user-select: none;
-ms-user-select: none;
user-select: none;
touch-action: pan-x pan-y;
-webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}

.calc {
width: 100vw;
height: 100vh;
max-width: none;
padding: var(--gap);
box-sizing: border-box;
position: relative;
margin-top: 0;
display: flex;
flex-direction: column;
justify-content: flex-end;
}

.display {
min-height: 20vh;
width: 100%;
display: flex;
align-items: flex-end;
justify-content: flex-end;
padding: 0 10px 20px 10px;
box-sizing: border-box;
font-size: 70px;
line-height: 1;
overflow-wrap: break-word;
text-align: right;
flex-grow: 1;
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
}

.display.result {
background: rgba(255, 149, 0, 0.1);
border: 2px solid var(--btn-orange);
border-radius: 20px;
padding: 10px;
margin-bottom: 10px;
animation: resultGlow 0.5s ease-in-out;
}

@keyframes resultGlow {
0% { background: rgba(255, 149, 0, 0.3); }
100% { background: rgba(255, 149, 0, 0.1); }
}

.pad {
display: grid;
grid-template-columns: repeat(4, 1fr);
gap: var(--gap);
margin-top: 12px;
justify-items: center;
width: 100%;
grid-auto-rows: 1fr;
}

button {
width: 100%;
aspect-ratio: 1;
border-radius: 50%;
border: none;
font-size: var(--font-size-btn);
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
transition: transform 0.06s ease;
color: var(--display-color);
-webkit-tap-highlight-color: transparent;
}

button:active {
transform: scale(0.95);
filter: brightness(1.2);
}

.btn-ac,
.btn-fn {
background: var(--btn-grey);
color: var(--bg);
}

.btn-num {
background: var(--btn-dark);
color: var(--display-color);
}

.btn-op {
background: var(--btn-orange);
color: var(--display-color);
font-size: var(--font-size-op);
}

.ads-button {
background-color: var(--btn-dark);
color: var(--display-color);
font-size: 20px;
width: 100%;
height: 100%;
border-radius: 50%;
display: flex;
justify-content: center;
align-items: center;
cursor: pointer;
}

@media (max-width: 480px) {
:root {
--gap: 10px;
--font-size-btn: 44px;
--font-size-op: 48px;
}

.display {
font-size: 60px;
}
}

@media (max-width: 380px) {
.display {
font-size: 50px;
}
}
</style>
</head>

<body>
<main class="calc" id="calculatorApp">
<div class="display" id="display">0</div>

<div class="pad">
<button class="btn-ac" id="ac">AC</button>
<button class="btn-fn" id="plusminus">+/-</button>
<button class="btn-fn" id="percent">%</button>
<button class="btn-op" data-op="/">÷</button>

<button class="btn-num" data-num="7">7</button>
<button class="btn-num" data-num="8">8</button>
<button class="btn-num" data-num="9">9</button>
<button class="btn-op" data-op="*">×</button>

<button class="btn-num" data-num="4">4</button>
<button class="btn-num" data-num="5">5</button>
<button class="btn-num" data-num="6">6</button>
<button class="btn-op" data-op="-">−</button>

<button class="btn-num" data-num="1">1</button>
<button class="btn-num" data-num="2">2</button>
<button class="btn-num" data-num="3">3</button>
<button class="btn-op" data-op="+">+</button>

<button class="ads-button" id="adsButton" onclick="window.open('https://otieu.com/4/10000601', '_blank')">ads</button>
<button class="btn-num" data-num="0">0</button>
<button class="btn-num" id="dot">,</button>
<button class="btn-op" id="equals">=</button>
</div>
</main>

<script>
(() => {
const displayEl = document.getElementById('display');
const btns = document.querySelectorAll('.pad button');
let expression = "";
let lastResult = null;
let isResultDisplayed = false;

function updateDisplay() {
displayEl.textContent = expression || "0";
    
// Αυτόματη προσαρμογή μεγέθους γραμματοσειράς για μεγάλους αριθμούς
const displayWidth = displayEl.clientWidth;
const textWidth = displayEl.scrollWidth;
    
if (textWidth > displayWidth - 20) {
// Υπολογισμός νέου μεγέθους γραμματοσειράς βάσει αναλογίας
const scaleFactor = (displayWidth - 40) / textWidth;
const newFontSize = Math.floor(70 * scaleFactor);
displayEl.style.fontSize = Math.max(30, newFontSize) + 'px';
} else {
displayEl.style.fontSize = '70px';
}
    
// Προσθήκη κλάσης result όταν εμφανίζεται αποτέλεσμα
if (isResultDisplayed) {
displayEl.classList.add('result');
} else {
displayEl.classList.remove('result');
}
}

function toEvalExpr(expr) {
return expr.replace(/,/g, ".").replace(/÷/g, "/").replace(/×/g, "*").replace(/−/g, "-").replace(/%/g, "/100");
}

function inputDigit(d) {
if (expression === "Error") {
clearAll();
}
if (isResultDisplayed) {
expression = "";
isResultDisplayed = false;
}
if (expression === "0" && d === "0") return;
if (expression === "0" && d !== "0") {
expression = d;
} else {
expression += d;
}
updateDisplay();
}

function inputDot() {
if (expression === "Error") {
clearAll();
}
if (isResultDisplayed) {
expression = "0,";
isResultDisplayed = false;
} else if (expression === "") {
expression = "0,";
} else {
const parts = expression.split(/([+\-×÷])/);
const lastPart = parts[parts.length - 1];
if (!lastPart.includes(',')) {
expression += ',';
}
}
updateDisplay();
}

function clearAll() {
expression = "";
lastResult = null;
isResultDisplayed = false;
updateDisplay();
}

function toggleSign() {
if (expression === "" || expression === "0" || expression === "Error") return;
const parts = expression.split(/([+\-×÷])/);
let lastPart = parts.pop().trim();
if (lastPart === "") return;
let newValue;
if (lastPart.startsWith('−')) {
newValue = lastPart.substring(1);
} else {
newValue = '−' + lastPart;
}
parts.push(newValue);
expression = parts.join('');
updateDisplay();
}

function percent() {
if (expression === "" || expression === "0" || expression === "Error") return;
const parts = expression.split(/([+\-×÷])/);
const lastNumberStr = parts.pop().replace(',', '.');
const lastNumber = parseFloat(lastNumberStr);
if (isNaN(lastNumber)) return;
let newValue = (lastNumber / 100).toString().replace('.', ',');
parts.push(newValue);
expression = parts.join('');
updateDisplay();
}

function inputOperator(op) {
if (expression === "") return;
if (expression === "Error") {
expression = String(lastResult).replace('.', ',');
}
isResultDisplayed = false;
const lastChar = expression.slice(-1);
if ("+−×÷".includes(lastChar)) {
expression = expression.slice(0, -1);
}
expression += (op === "*" ? "×" : op === "/" ? "÷" : op === "-" ? "−" : "+") + " ";
updateDisplay();
}

function calculateEquals() {
if (expression === "" || expression === "Error") return;
try {
let evalExpr = toEvalExpr(expression);
let result = eval(evalExpr);
if (result % 1 !== 0) {
result = parseFloat(result.toFixed(10));
}
expression = String(result).replace('.', ',');
lastResult = result;
isResultDisplayed = true;
updateDisplay();
} catch (e) {
expression = "Error";
isResultDisplayed = false;
updateDisplay();
}
}

btns.forEach(b => {
b.addEventListener('click', () => {
if (b.dataset.num) inputDigit(b.dataset.num);
else if (b.id === 'dot') inputDot();
else if (b.id === 'ac') clearAll();
else if (b.id === 'plusminus') toggleSign();
else if (b.id === 'percent') percent();
else if (b.id === 'equals') calculateEquals();
else if (b.dataset.op) inputOperator(b.dataset.op);
});
});

updateDisplay();
})();
</script>
</body>

</html>
